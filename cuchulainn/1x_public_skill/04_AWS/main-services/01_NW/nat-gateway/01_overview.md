# NAT Gateway 概要

## 1. サービスの役割

NAT Gatewayは、プライベートサブネット内のリソースがインターネットに安全にアクセスするためのマネージドサービスです。プライベートIPアドレスをパブリックIPアドレスに変換（NAT）し、アウトバウンド接続のみを許可します。インバウンド接続は受け付けないため、セキュリティが向上します。

## 2. 主なユースケース

- プライベートサブネット内のEC2インスタンスからのインターネットアクセス（ソフトウェア更新、API呼び出しなど）
- プライベートサブネット内のRDSやElastiCacheからのセキュリティパッチのダウンロード
- プライベートサブネット内のLambda関数からの外部API呼び出し
- データベースサーバーなど、インターネットから直接アクセスさせたくないリソースの配置

## 3. 他サービスとの関係

- **VPC**: NAT GatewayはVPC内に作成される
- **Subnet**: パブリックサブネットに配置する必要がある（IGW経由でインターネットにアクセスするため）
- **Route Table**: プライベートサブネットのルートテーブルに0.0.0.0/0 → NAT Gatewayのルートを設定
- **Internet Gateway**: NAT GatewayはIGW経由でインターネットにアクセス
- **EC2, RDS, Lambda**: プライベートサブネット内のリソースがNAT Gateway経由でインターネットにアクセス

## 4. 料金のざっくりイメージ

- NAT Gateway自体の料金: 約$0.045/時間（約$32/月）
- データ転送料金: GBあたり$0.045（アウトバウンド）
- **注意**: NAT Gatewayは割高なサービスなので、本当に必要な場合のみ使用する

## 5. 初心者がまず覚えるべきポイント

- NAT Gatewayは割高なので、本当に必要な場合のみ使用する
- NAT Gatewayは「AZごとのリソース」なので、冗長性を持たせたいなら最低2つは必要
  - 例: private-subnet-1aにだけNAT Gatewayを作って、private-subnet-1cのルーティングテーブルのデフォルトゲートウェイを1aのNAT Gatewayにしても、1cのAZがダウンした場合に問題が発生する
- NAT Gatewayはパブリックサブネットに配置する必要がある
- インバウンド接続は受け付けない（アウトバウンドのみ）
- Elastic IPアドレスが自動的に割り当てられる
- 高可用性のため、各AZにNAT Gatewayを配置するのがベストプラクティス


